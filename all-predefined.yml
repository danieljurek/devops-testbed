# trigger: 
#   branches:
#     include:
#       - main


jobs: 
  - job: setupazd
    strategy: 
      matrix:
        Windows:
          vmImage: windows-latest
        Linux:
          vmImage: ubuntu-latest
        Mac:
          vmImage: macos-latest

    pool:
      vmImage: $(vmImage)

    steps: 
      - pwsh: |
          try { 
              $result = Invoke-WebRequest -Uri https://azd-release-gfgac2cmf7b8cuay.b02.azurefd.net/azd/standalone/release/latest/azd-linux-amd64.tar.gz
              $result.Headers | Format-Table -AutoSize -Wrap
          } catch { 
              Write-Host "Failure: Invoke-WebRequest threw an error"
              $_ | Write-Host
              $_.Exception.Response.Headers | Format-Table -AutoSize -Wrap
              exit 1
          }
        displayName: Try downloading azd

      - pwsh: |
          try { 
              $result = Invoke-WebRequest -Uri https://azd-release-gfgac2cmf7b8cuay.b02.azurefd.net/azd/standalone/release/latest/azd-linux-amd64.tar.gzzzzz404
              $result.Headers | Format-Table -AutoSize -Wrap
          } catch { 
              Write-Host "Failure: Invoke-WebRequest threw an error"
              $_ | Write-Host
              $_.Exception.Response.Headers | Format-Table -AutoSize -Wrap
              exit 1
          }
        displayName: Try downloading azd (fail)
